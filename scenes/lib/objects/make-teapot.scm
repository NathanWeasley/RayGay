
;; The teapot consist of 32 bezier patches.
;; TODO: Swap y,z values
(define (make-teapot xresolution yresolution material)
  (let loop 
    ((coords '(
	       (-80 0 30) (-80 -44.80 30) (-44.80 -80 30) (0 -80 30)
	       (-80 0 12) (-80 -44.80 12) (-44.80 -80 12) (0 -80 12)
	       (-60 0 3) (-60 -33.60 3) (-33.60 -60 3) (0 -60 3)
	       (-60 0 0) (-60 -33.60 0) (-33.60 -60 0) (0 -60 0)

	       (0 -80 30) (44.80 -80 30) (80 -44.80 30) (80 0 30)
	       (0 -80 12) (44.80 -80 12) (80 -44.80 12) (80 0 12)
	       (0 -60 3) (33.60 -60 3) (60 -33.60 3) (60 0 3)
	       (0 -60 0) (33.60 -60 0) (60 -33.60 0) (60 0 0)

	       (-60 0 90) (-60 -33.60 90) (-33.60 -60 90) (0 -60 90)
	       (-70 0 69) (-70 -39.20 69) (-39.20 -70 69) (0 -70 69)
	       (-80 0 48) (-80 -44.80 48) (-44.80 -80 48) (0 -80 48)
	       (-80 0 30) (-80 -44.80 30) (-44.80 -80 30) (0 -80 30)

	       (0 -60 90) (33.60 -60 90) (60 -33.60 90) (60 0 90)
	       (0 -70 69) (39.20 -70 69) (70 -39.20 69) (70 0 69)
	       (0 -80 48) (44.80 -80 48) (80 -44.80 48) (80 0 48)
	       (0 -80 30) (44.80 -80 30) (80 -44.80 30) (80 0 30)

	       (-56 0 90) (-56 -31.36 90) (-31.36 -56 90) (0 -56 90)
	       (-53.50 0 95.25) (-53.50 -29.96 95.25) (-29.96 -53.50 95.25) (0 -53.50 95.25)
	       (-57.50 0 95.25) (-57.50 -32.20 95.25) (-32.20 -57.50 95.25) (0 -57.50 95.25)
	       (-60 0 90) (-60 -33.60 90) (-33.60 -60 90) (0 -60 90)

	       (0 -56 90) (31.36 -56 90) (56 -31.36 90) (56 0 90)
	       (0 -53.50 95.25) (29.96 -53.50 95.25) (53.50 -29.96 95.25) (53.50 0 95.25)
	       (0 -57.50 95.25) (32.20 -57.50 95.25) (57.50 -32.20 95.25) (57.50 0 95.25)
	       (0 -60 90) (33.60 -60 90) (60 -33.60 90) (60 0 90)

	       (80 0 30) (80 44.80 30) (44.80 80 30) (0 80 30)
	       (80 0 12) (80 44.80 12) (44.80 80 12) (0 80 12)
	       (60 0 3) (60 33.60 3) (33.60 60 3) (0 60 3)
	       (60 0 0) (60 33.60 0) (33.60 60 0) (0 60 0)

	       (0 80 30) (-44.80 80 30) (-80 44.80 30) (-80 0 30)
	       (0 80 12) (-44.80 80 12) (-80 44.80 12) (-80 0 12)
	       (0 60 3) (-33.60 60 3) (-60 33.60 3) (-60 0 3)
	       (0 60 0) (-33.60 60 0) (-60 33.60 0) (-60 0 0)

	       (60 0 90) (60 33.60 90) (33.60 60 90) (0 60 90)
	       (70 0 69) (70 39.20 69) (39.20 70 69) (0 70 69)
	       (80 0 48) (80 44.80 48) (44.80 80 48) (0 80 48)
	       (80 0 30) (80 44.80 30) (44.80 80 30) (0 80 30)

	       (0 60 90) (-33.60 60 90) (-60 33.60 90) (-60 0 90)
	       (0 70 69) (-39.20 70 69) (-70 39.20 69) (-70 0 69)
	       (0 80 48) (-44.80 80 48) (-80 44.80 48) (-80 0 48)
	       (0 80 30) (-44.80 80 30) (-80 44.80 30) (-80 0 30)

	       (56 0 90) (56 31.36 90) (31.36 56 90) (0 56 90)
	       (53.50 0 95.25) (53.50 29.96 95.25) (29.96 53.50 95.25) (0 53.50 95.25)
	       (57.50 0 95.25) (57.50 32.20 95.25) (32.20 57.50 95.25) (0 57.50 95.25)
	       (60 0 90) (60 33.60 90) (33.60 60 90) (0 60 90)

	       (0 56 90) (-31.36 56 90) (-56 31.36 90) (-56 0 90)
	       (0 53.50 95.25) (-29.96 53.50 95.25) (-53.50 29.96 95.25) (-53.50 0 95.25)
	       (0 57.50 95.25) (-32.20 57.50 95.25) (-57.50 32.20 95.25) (-57.50 0 95.25)
	       (0 60 90) (-33.60 60 90) (-60 33.60 90) (-60 0 90)

	       (-64 0 75) (-64 12 75) (-60 12 84) (-60 0 84)
	       (-92 0 75) (-92 12 75) (-100 12 84) (-100 0 84)
	       (-108 0 75) (-108 12 75) (-120 12 84) (-120 0 84)
	       (-108 0 66) (-108 12 66) (-120 12 66) (-120 0 66)

	       (-60 0 84) (-60 -12 84) (-64 -12 75) (-64 0 75)
	       (-100 0 84) (-100 -12 84) (-92 -12 75) (-92 0 75)
	       (-120 0 84) (-120 -12 84) (-108 -12 75) (-108 0 75)
	       (-120 0 66) (-120 -12 66) (-108 -12 66) (-108 0 66)

	       (-108 0 66) (-108 12 66) (-120 12 66) (-120 0 66)
	       (-108 0 57) (-108 12 57) (-120 12 48) (-120 0 48)
	       (-100 0 39) (-100 12 39) (-106 12 31.50) (-106 0 31.50)
	       (-80 0 30) (-80 12 30) (-76 12 18) (-76 0 18)

	       (-120 0 66) (-120 -12 66) (-108 -12 66) (-108 0 66)
	       (-120 0 48) (-120 -12 48) (-108 -12 57) (-108 0 57)
	       (-106 0 31.50) (-106 -12 31.50) (-100 -12 39) (-100 0 39)
	       (-76 0 18) (-76 -12 18) (-80 -12 30) (-80 0 30)

	       (68 0 51) (68 26.40 51) (68 26.40 18) (68 0 18)
	       (104 0 51) (104 26.40 51) (124 26.40 27) (124 0 27)
	       (92 0 78) (92 10 78) (96 10 75) (96 0 75)
	       (108 0 90) (108 10 90) (132 10 90) (132 0 90)

	       (68 0 18) (68 -26.40 18) (68 -26.40 51) (68 0 51)
	       (124 0 27) (124 -26.40 27) (104 -26.40 51) (104 0 51)
	       (96 0 75) (96 -10 75) (92 -10 78) (92 0 78)
	       (132 0 90) (132 -10 90) (108 -10 90) (108 0 90)

	       (108 0 90) (108 10 90) (132 10 90) (132 0 90)
	       (112 0 93) (112 10 93) (141 10 93.75) (141 0 93.75)
	       (116 0 93) (116 6 93) (138 6 94.50) (138 0 94.50)
	       (112 0 90) (112 6 90) (128 6 90) (128 0 90)

	       (132 0 90) (132 -10 90) (108 -10 90) (108 0 90)
	       (141 0 93.75) (141 -10 93.75) (112 -10 93) (112 0 93)
	       (138 0 94.50) (138 -6 94.50) (116 -6 93) (116 0 93)
	       (128 0 90) (128 -6 90) (112 -6 90) (112 0 90)

	       (50 0 90) (50 28 90) (28 50 90) (0 50 90)
	       (52 0 90) (52 29.12 90) (29.12 52 90) (0 52 90)
	       (54 0 90) (54 30.24 90) (30.24 54 90) (0 54 90)
	       (56 0 90) (56 31.36 90) (31.36 56 90) (0 56 90)

	       (0 50 90) (-28 50 90) (-50 28 90) (-50 0 90)
	       (0 52 90) (-29.12 52 90) (-52 29.12 90) (-52 0 90)
	       (0 54 90) (-30.24 54 90) (-54 30.24 90) (-54 0 90)
	       (0 56 90) (-31.36 56 90) (-56 31.36 90) (-56 0 90)

	       (-50 0 90) (-50 -28 90) (-28 -50 90) (0 -50 90)
	       (-52 0 90) (-52 -29.12 90) (-29.12 -52 90) (0 -52 90)
	       (-54 0 90) (-54 -30.24 90) (-30.24 -54 90) (0 -54 90)
	       (-56 0 90) (-56 -31.36 90) (-31.36 -56 90) (0 -56 90)

	       (0 -50 90) (28 -50 90) (50 -28 90) (50 0 90)
	       (0 -52 90) (29.12 -52 90) (52 -29.12 90) (52 0 90)
	       (0 -54 90) (30.24 -54 90) (54 -30.24 90) (54 0 90)
	       (0 -56 90) (31.36 -56 90) (56 -31.36 90) (56 0 90)

	       (8 0 102) (8 4.48 102) (4.48 8 102) (0 8 102)
	       (16 0 96) (16 8.96 96) (8.96 16 96) (0 16 96)
	       (52 0 96) (52 29.12 96) (29.12 52 96) (0 52 96)
	       (52 0 90) (52 29.12 90) (29.12 52 90) (0 52 90)

	       (0 8 102) (-4.48 8 102) (-8 4.48 102) (-8 0 102)
	       (0 16 96) (-8.96 16 96) (-16 8.96 96) (-16 0 96)
	       (0 52 96) (-29.12 52 96) (-52 29.12 96) (-52 0 96)
	       (0 52 90) (-29.12 52 90) (-52 29.12 90) (-52 0 90)

	       (-8 0 102) (-8 -4.48 102) (-4.48 -8 102) (0 -8 102)
	       (-16 0 96) (-16 -8.96 96) (-8.96 -16 96) (0 -16 96)
	       (-52 0 96) (-52 -29.12 96) (-29.12 -52 96) (0 -52 96)
	       (-52 0 90) (-52 -29.12 90) (-29.12 -52 90) (0 -52 90)

	       (0 -8 102) (4.48 -8 102) (8 -4.48 102) (8 0 102)
	       (0 -16 96) (8.96 -16 96) (16 -8.96 96) (16 0 96)
	       (0 -52 96) (29.12 -52 96) (52 -29.12 96) (52 0 96)
	       (0 -52 90) (29.12 -52 90) (52 -29.12 90) (52 0 90)

	       (0 0 120) (0 0 120) (0 0 120) (0 0 120)
	       (32 0 120) (32 18 120) (18 32 120) (0 32 120)
	       (0 0 108) (0 0 108) (0 0 108) (0 0 108)
	       (8 0 102) (8 4.48 102) (4.48 8 102) (0 8 102)

	       (0 0 120) (0 0 120) (0 0 120) (0 0 120)
	       (0 32 120) (-18 32 120) (-32 18 120) (-32 0 120)
	       (0 0 108) (0 0 108) (0 0 108) (0 0 108)
	       (0 8 102) (-4.48 8 102) (-8 4.48 102) (-8 0 102)

	       (0 0 120) (0 0 120) (0 0 120) (0 0 120)
	       (-32 0 120) (-32 -18 120) (-18 -32 120) (0 -32 120)
	       (0 0 108) (0 0 108) (0 0 108) (0 0 108)
	       (-8 0 102) (-8 -4.48 102) (-4.48 -8 102) (0 -8 102)

	       (0 0 120) (0 0 120) (0 0 120) (0 0 120)
	       (0 -32 120) (18 -32 120) (32 -18 120) (32 0 120)
	       (0 0 108) (0 0 108) (0 0 108) (0 0 108)
	       (0 -8 102) (4.48 -8 102) (8 -4.48 102) (8 0 102)
	       )))
    (if (null? coords)
      '()
      (cons
	(make-bezierpatch
	  (list-head coords 16)
	  xresolution yresolution material)
	(loop (list-tail coords 16))))
      ))

